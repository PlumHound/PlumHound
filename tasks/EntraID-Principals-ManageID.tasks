[ "Return all Azure Service Principals", "HTMLCSV", "EID-AllPrincipals", "MATCH (sp:AZServicePrincipal) RETURN sp" ]
[ "Find all VMs with a tied Managed Identity", "HTMLCSV", "EID-VMwithManagedID", "MATCH p=(:AZVM)-[:AZManagedIdentity]->(n) RETURN p" ]
[ "Return all Azure Service Principals that are Managed Identities", "HTMLCSV", "EID-AllManagedID", "MATCH (sp:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'}) RETURN sp"]
[ "Return all Azure Service Principals that are tied to Apps", "HTMLCSV", "EID-PrincipalswithApp", "MATCH (sp:AZServicePrincipal {serviceprincipaltype: 'Application'}) RETURN sp" ]
[ "Find all Azure Privileged Service Principals", "HTMLCSV", "EID-PrivPrincipals", "MATCH p = (g:AZServicePrincipal)-[]->(n) RETURN p" ]
[ "Find shortest Paths from Owned Azure Users to Azure Service Principals", "HTMLCSV", "EID-Own2Service", "MATCH (u:AZUser {owned: true}), (m:AZServicePrincipal) MATCH p = shortestPath((u)-[*..]->(m)) RETURN p" ]
[ "Find shortest Paths from Owned Azure Users to Azure Service Principals that are Managed Identities", "HTMLCSV", "EID-Own2ManagedID", "MATCH (u:AZUser {owned: true}), (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'}) MATCH p = shortestPath((u)-[*..]->(m)) RETURN p" ]
[ "Find shortest Paths from all Azure Users to Azure Service Principals that are Managed Identities", "HTMLCSV", "EID-User2ManagedID", "MATCH (u:AZUser), (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'}) MATCH p = shortestPath((u)-[*..]->(m)) RETURN p" ]
[ "Find all Service Principals that are Managed Identities an have a Path to an Azure Key Vault", "HTMLCSV", "EID-ManagedID2KeyVault", "MATCH (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'})-[*]->(kv:AZKeyVault) WITH collect(m) AS managedIdentities MATCH p = (n)-[r]->(kv:AZKeyVault) WHERE n IN managedIdentities RETURN p" ]
[ "Find Paths from Managed Identities tied to a VM with a path to a Key Vault", "HTMLCSV", "EID-ManagedIDVM2KeyVault", "MATCH p1 = (:AZVM)-[:AZManagedIdentity]->(n) WITH collect(n) AS managedIdentities MATCH p2 = (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'})-[*]->(kv:AZKeyVault) WHERE m IN managedIdentities RETURN p2" ]