[ "Return all Service Principals with MS Graph AZMGGrantAppRoles rights -> PrivEsc Path to Global Admin", "HTMLCSV", "EID-GrantApp2GA", "MATCH p=(n)-[r:AZMGGrantAppRoles]->(o:AZTenant) RETURN p" ]
[ "Return all Service Principals with MS Graph App Role Assignments", "HTMLCSV", "EID-GrantAppRole", "MATCH p=(m:AZServicePrincipal)-[r:AZMGAppRoleAssignment_ReadWrite_All|AZMGApplication_ReadWrite_All|AZMGDirectory_ReadWrite_All|AZMGGroupMember_ReadWrite_All|AZMGGroup_ReadWrite_All|AZMGRoleManagement_ReadWrite_Directory|AZMGServicePrincipalEndpoint_ReadWrite_All]->(n:AZServicePrincipal) RETURN p" ]
[ "Return all direct Controllers of MS Graph", "HTMLCSV", "EID-GraphControlers", "MATCH p = (n)-[r:AZAddOwner|AZAddSecret|AZAppAdmin|AZCloudAppAdmin|AZMGAddOwner|AZMGAddSecret|AZOwns]->(g:AZServicePrincipal {appdisplayname: 'Microsoft Graph'}) RETURN p" ]
[ "Find shortest Paths to MS Graph", "HTMLCSV", "EID-Path2Graph", "MATCH (n) WHERE NOT n.displayname='Microsoft Graph' WITH n MATCH p = shortestPath((n)-[r*1..]->(g:AZServicePrincipal {appdisplayname: 'Microsoft Graph'})) WHERE n<>g RETURN p" ]